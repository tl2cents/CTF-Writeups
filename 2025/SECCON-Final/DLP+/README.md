
## Wrietup(CN)


## wp

寻找特殊素数使得 $`g^k = h \mod p`$, 其中 k 是一个小素数，不妨假设 $`p = 1 \mod 6`$, 则  $`g^k = h \mod p`$ 等价于

$$
(-1/2)^k = (-1/3) \mod p
$$

即

$$
(-2)^k + 3 = 0 \mod p
$$

因此穷举 k, 寻找左式的素因子，直到我们找到一个光滑的素因子 p, 光滑的阶大于 2^520 即可。一个可行的素数和 k 满足

``` python
p = 15716184699547462800461771601028927135348272154927459012381834606394607906735138215326765472045739095867667862791827281627279676331280673025582786492800565034681474589962543612181570816917654358007798115791387579073196284235251797321810838517520967959561184040912976519718458581462926905245885178079360322053716674233519451182638293301601
k = 1125
smooth_order = 81702288101897374130672874598561902721173468294968431566564038710852096398047085617569136205194590591076494888575280919059927276469484223384374847874938192122852470746278712759413600
```

然后求解 

$$
y + y^k - r = 0 \mod p
$$

其中 $y = g^x$ , 进一步求解离散对数得到 x。
